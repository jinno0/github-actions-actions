# Gap Analysis
# Generated by Repo Genesis Auditor v2.0
# Run ID: 2026-02-04T04:00:00Z

version: "2.0"
generated_at: "2026-02-04T04:00:00Z"

# === Identified Gaps ===

gaps:
  # === Critical Gaps ===
  - id: "GAP-001"
    severity: "high"
    category: "operational"
    title: "AIレビュー受入率が測定不能"
    current_state: "本番レビュー実績が0件"
    desired_state: "AIレビュー受入率>=70%が測定可能"
    gap_description: |
      scripts/calculate_acceptance_rate.py は機能しているが、
      本番環境でレビューが実施されていないため、受入率を測定できない。
      ASM-004の仮定を検証できない状態。
    impact: |
      - 品質目標（QA-002）の達成判定ができない
      - ASM-004の仮定がconfirmedにもrejectedにもなれない
      - README.mdで記載している目標値の根拠を示せない
    evidence: "C-022, C-028"
    assumption_dependency: "ASM-004"

  # === Medium Gaps ===
  - id: "GAP-002"
    severity: "medium"
    category: "structure"
    title: "テンプレートファイル完備率が38.5%に留まる"
    current_state: "5/13 actionsのみがtemplates/ディレクトリを持っている"
    desired_state: "全13 actionsがtemplates/ディレクトリを持つ（QA-005）"
    gap_description: |
      8つのactionがtemplatesディレクトリを持っていない:
      - _shared/, auto-merge/, bulk-merge-prs/, bulk-rebase-prs/
      - lib/, pr-review-enqueuer/, publish-pr/, review-auto-merge/

      これらのactionはコンポジットアクションのrun.steps内で
      直接スクリプトを記述しており、テンプレート分離されていない。
    impact: |
      - 保守性が低下（ロジック変更時にaction.ymlを直接編集する必要）
      - テスト可能性が制限（テンプレート注入ができない）
      - QA-005の目標未達成
    evidence: "C-024, C-029"
    quality_attribute_dependency: "QA-005"

  # === Low Priority Gaps ===
  - id: "GAP-003"
    severity: "low"
    category: "operational"
    title: "テレメトリーデータが収集されていない"
    current_state: "metrics/telemetry/telemetry.log が存在しない"
    desired_state: "テレメトリーデータが収集され、レポート生成が可能"
    gap_description: |
      scripts/generate_telemetry_report.py は実装済みだが、
      テレメトリーログファイルが存在しないため、レポートが空。
    impact: |
      - Actionの使用状況を把握できない
      - ISS-020（各Actionの実行回数と成功率）が解決できない
    evidence: "C-023"

# === Resolved Issues from Previous Run ===
resolved_issues:
  - id: "RESOLVED-001"
    original_issue: "ISS-NEW-001 (Coverage Audit Discrepancy)"
    resolution: |
      前回の監査で「カバレッジ23.06%」と報告されたが、
      実際には93.93%であった。監査手法の誤りを修正。
    evidence: "C-021, C-026, C-027"

  - id: "RESOLVED-002"
    original_issue: "ISS-NEW-002 (Verification Script Not Implemented)"
    resolution: |
      verify_core_functions.py が実装された（10,532バイト）。
      構造検証アプローチでCore Function検証が可能になった。
    evidence: "C-025"

# === Assumption Status Updates ===
assumption_updates:
  - id: "ASM-003"
    field: "test_coverage"
    previous_status: "unverified"
    new_status: "confirmed"
    value: ">= 93.93%"
    evidence: "C-021, C-026"
    confidence_upgrade: "high → confirmed"

  - id: "ASM-004"
    field: "ai_acceptance_rate"
    previous_status: "unverified"
    new_status: "needs_data"
    value: "unknown (no production data)"
    evidence: "C-022, C-028"
    note: "仮定値70%は維持するが、測定可能になるまで検証保留"

# === Gap Prioritization ===
priority_matrix:
  high_priority:
    - "GAP-001: Operational measurements need production data"
    rationale: "品質目標の達成判定ができないため、最優先"

  medium_priority:
    - "GAP-002: Template completeness affects maintainability"
    rationale: "構造的品質の改善だが、機能には影響しない"

  low_priority:
    - "GAP-003: Telemetry data collection"
    rationale: "運用上の改善で、機能や品質に直接影響しない"

# === Summary ===
summary:
  total_gaps: 3
  high_severity: 1
  medium_severity: 1
  low_severity: 1
  resolved_from_previous: 2

  overall_assessment: |
    リポジトリは構造的に非常に健全であり、テストカバレッジも優れている（93.93%）。
    しかし、運用的な成熟度が低く、品質目標の達成判定ができない状態。
    特に、本番データの欠如が最大のボトルネック。

  critical_path: |
    1. 本番環境での導入促進（GAP-001の解決に必要）
    2. テンプレートの整理・統一（GAP-002の解決）
    3. テレメトリー収集の開始（GAP-003の解決）
