version: "2.0"
run_id: "2026-02-09T12:41:00Z"
generated_at: "2026-02-09T12:41:00Z"

# === ギャップ分析 ===

summary:
  total_gaps: 5
  critical: 1
  high: 2
  medium: 2
  low: 0
  intent_achievement_score: 72  # /100 (up from 65 due to QA-003 improvement)

gaps:
  # === 外部採用（mission.desired_state） ===
  - id: "GAP-001"
    severity: "critical"
    category: "adoption"
    affected_intent: "mission.desired_state"
    intent:
      target: "組織内の複数リポジトリで採用され、AIに任せられる雑務が増える"
      source: "intent.yml:9"
    current_state:
      actual: "外部採用数: 0件"
      phase: "Phase 3 (Stabilization & Adoption)"
      note: "PR-001で採用キャンペーン実施済みだが成果なし"
    gap_description: |
      プロジェクトはPhase 3（普及フェーズ）だが、外部採用が0件。
      PR-001（採用キャンペーン）でドキュメント改善を実施したが、
      実際のアウトリーチ活動が実施されていないため、成果が出ていない。
      「良いドキュメントを作れば使ってもらえる」という仮説が崩壊中。
    impact: |
      ASM-001の仮定「Self-hosted runnerを運用するGitHub組織」が
      リーチできていない。プロジェクトの存続可能性に関わる。
      改善サイクルを回すための実ユーザー不在。
    confidence: "high"
    assumptions:
      - id: "ASM-NEW-001"
        description: "直接アウトリーチがドキュメント改善より10倍効果的"
        confidence: "high"
    recommended_actions:
      - priority: 1
        action: "組織内での直接アウトリーチ（チームミーティング、1on 1）"
        estimated_effort: "5-10 hours"
        expected_outcome: "パイロット参加者2-3件"

      - priority: 2
        action: "GitHub Discussionsでのアナウンス"
        estimated_effort: "1-2 hours"

      - priority: 3
        action: "カンファレンスや勉強会での発表"
        estimated_effort: "10-20 hours"

  # === テストカバレッジ（QA-001） ===
  - id: "GAP-002"
    severity: "high"
    category: "code_coverage"
    affected_qa: "QA-001 (テストカバレッジ)"
    intent:
      target: "テストカバレッジ >= 80%"
      source: "intent.yml:93-106"
    current_state:
      actual: "78.15% (全体)"
      breakdown:
        - "generate_review_quality_dashboard.py: 0.00% (128行全て未カバー)"
        - "test_data_collection.py: 0.00% (38行全て未カバー)"
        - "env_config.py: 47.83% (依然として最低)"
    gap_description: |
      全体カバレッジが目標値80%をわずかに下回る78.15%。
      2つのスクリプトが0%カバレッジで、これが目標未達の主要原因。
    impact: |
      品質属性QA-001未達成。CIカバレッジチェックに失敗する可能性。
    confidence: "high"
    recommended_actions:
      - priority: 1
        action: "generate_review_quality_dashboard.pyのテスト追加"
        estimated_effort: "3-5 hours"
        expected_outcome: "カバレッジ78.15% → 82%+"

      - priority: 2
        action: "test_data_collection.pyのテスト追加"
        estimated_effort: "2-3 hours"
        expected_outcome: "カバレッジ78.15% → 81%+"

  # === AIレビューサンプルサイズ ===
  - id: "GAP-003"
    severity: "high"
    category: "measurement_validity"
    affected_qa: "QA-003 (AIレビュー受入率)"
    intent:
      target: "サンプル数 >= 20件"
      source: "intent.yml:123-134"
    current_state:
      actual: "10件"
      acceptance_rate: "70.0% (目標達成)"
      progress: "データ収集中"
    gap_description: |
      受入率は目標の70%を達成したが、サンプル数が10件で目標の半分。
      統計的有意性を得るには更に10件必要。
    impact: "統計的有意性が不足。傾向分析の信頼性が低い。"
    confidence: "medium"
    recommended_actions:
      - priority: 1
        action: "複数プロジェクトでのレビュー実施キャンペーン"
        estimated_effort: "ongoing"
        expected_outcome: "サンプル数10件 → 20件以上"

  # === 技術的負債 ===
  - id: "GAP-004"
    severity: "medium"
    category: "code_quality"
    affected_intent: "コード品質の維持"
    intent:
      target: "全スクリプトがテストされている"
      source: "QA-001 implicit"
    current_state:
      actual: "2/10 scriptsが0%カバレッジ"
      uncovered:
        - "generate_review_quality_dashboard.py: 0% (128行)"
        - "test_data_collection.py: 0% (38行)"
    gap_description: |
      2つのスクリプトでテストカバレッジ0%。
      test_data_collection.pyはユーティリティ扱いでテスト対象外。
    impact: "コード品質の保証ができない。リファクタリング時のリスク。"
    confidence: "medium"
    recommended_actions:
      - priority: 2
        action: "generate_review_quality_dashboard.pyのテスト追加"
        estimated_effort: "3-5 hours"

      - priority: 3
        action: "test_data_collection.pyのテスト追加または除外の明確化"
        estimated_effort: "2-3 hours"

  # === 改善戦略の効果測定 ===
  - id: "GAP-005"
    severity: "medium"
    category: "improvement_effectiveness"
    affected_intent: "監査-改善サイクルの有効性"
    intent:
      target: "改善提案が意図した効果を表している"
      source: "feedback_to_auditor.yml"
    current_state:
      actual: "PR-002の効果が部分的に確認、PR-001は成果0件"
      verification_pass_rate: "100% (5/5シナリオパス)"
      improvements:
        - "AIレビュー受入率: 60% → 70% (目標達成)"
        - "採用数: 0件 (変化なし)"
    gap_description: |
      前回実行で2つの改善提案を適用：
      1. PR-002（プロンプト改善）：受入率が改善（60% → 70%）
      2. PR-001（採用キャンペーン）：ドキュメント改善のみで採用数0件
      改善前後の比較測定が部分的にできている。
    impact: |
      改善サイクルの仮説検証が進展中。
      PR-002は成功、PR-001は追加措置（直接アウトリーチ）が必要。
    confidence: "high"
    recommended_actions:
      - priority: 1
        action: "PR-002のA/Bテスト実施による効果測定"
        estimated_effort: "1-2 weeks"

      - priority: 2
        action: "PR-001のアウトリーチ活動実施と効果測定"
        estimated_effort: "5-10 hours + 1 month tracking"

# === 前回監査からの変化 ===

changes_since_last_audit:
  improved:
    - gap_id: "QA-003 (previously GAP-001)"
      description: "AIレビュー受入率が目標未達から目標達成に改善"
      previous: "60.0% (below target)"
      current: "70.0% (target achieved)"
      severity_change: "critical → resolved"

    - gap_id: "GAP-003 (sample size)"
      description: "サンプル数が4件 → 10件に増加（+150%）"
      previous: "4件"
      current: "10件"
      achievement: "50%達成"

  unchanged:
    - gap_id: "GAP-001 (adoption)"
      description: "外部採用数0件（依然として停滞）"
      status: "no_progress"
      note: "PR-001実施したが、アウトリーチ活動が不足"

    - gap_id: "GAP-002 (test coverage)"
      description: "テストカバレッジ78.15%で横ばい（依然として80%未達）"
      status: "stagnant"
      note: "新規スクリプトのテスト追加が必要"

# === 達成度スコアリング ===

achievement_breakdown:
  test_coverage:
    score: 78
    max: 100
    rationale: "78.15% < 80% target (unchanged)"

  yaml_validity:
    score: 100
    max: 100
    rationale: "All 13 action.yml files are valid YAML"

  ai_review_acceptance_rate:
    score: 70
    max: 100
    rationale: "Target ACHIEVED (70% = 70%) but sample size still insufficient (10 < 20)"

  documentation_coverage:
    score: 100
    max: 100
    rationale: "All 13 actions have complete documentation"

  adoption:
    score: 20
    max: 100
    rationale: "0 external adopters despite PR-001 execution. Direct outreach needed"

  improvement_effectiveness:
    score: 65
    max: 100
    rationale: "PR-002 successful (60% → 70%), PR-001 needs additional outreach"

total_score: 72
max_score: 100
change_from_last_audit: "+7 points (65 → 72)"

# === 優先順位付け ===

priority_order:
  - priority: 1
    gap_id: "GAP-001"
    reason: "外部採用の打破（プロジェクト存続に関わる）"

  - priority: 2
    gap_id: "GAP-002"
    reason: "テストカバレッジ80%達成（品質基準）"

  - priority: 3
    gap_id: "GAP-003"
    reason: "サンプル数20件達成（測定信頼性）"

  - priority: 4
    gap_id: "GAP-004"
    reason: "技術的負債解消（コード品質）"

  - priority: 5
    gap_id: "GAP-005"
    reason: "改善効果測定（サイクル改善のため）"
