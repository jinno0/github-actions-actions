version: "2.0"
generated_at: "2026-02-02T23:57:00Z"
generated_by: "audit-run-001"

# === Gap Analysis ===
# Intent（仮定含む）と現状（as_is.yml）を比較し、ギャップを特定

gap_summary:
  total_gaps: 7
  critical_gaps: 1
  high_priority_gaps: 3
  medium_priority_gaps: 2
  low_priority_gaps: 1

# === Gaps by Category ===

gaps:
  # === Critical Gaps ===

  - id: "GAP-001"
    category: "Quality Attributes"
    severity: "Critical"
    title: "Acceptance Rate追跡機能の不在"
    description: "PURPOSE.mdで成功条件として定義されているが、実装されていない"

    intent_reference:
      source: "intent.yml quality_attributes.QA-004"
      target: "Acceptance Rateなどの指標でAIの提案品質を測定可能"
      assumption: "ASM-004: AIの提案に対する修正率（Acceptance Rate）が向上し続けることが成功条件"

    current_state:
      source: "as_is.yml quality_metrics.weaknesses"
      status: "Acceptance Rate追跡機能が未実装"
      evidence: "C-102: Acceptance Rateを追跡する仕組みは未実装 (confidence: 0.6)"

    gap_details:
      what_is_missing: "AIの提案に対する承認率を測定・追跡する仕組み"
      impact: "AIの品質改善サイクルが回せない。成功条件（Acceptance Rateの継続的向上）を測定できない"
      business_impact: "AIの提案精度が向上しているかどうかを証明できない"

    proposed_solutions:
      - id: "SOL-001-A"
        description: "メトリクス収集ワークフローの実装"
        effort: "Medium"
        impact: "High"
        details:
          - ".github/workflows/aggregate-metrics.ymlを拡張"
          - "review-and-merge等の実行結果からLGTM率を収集"
          - "GitHub APIを使用してPRのステータスを追跡"
          - "metrics/ディレクトリに時系列データを保存"

      - id: "SOL-001-B"
        description: "各Actionの出力ログにメトリクスを含める"
        effort: "Low"
        impact: "Medium"
        details:
          - "各action.ymlにoutputsを追加"
          - "AI提案の採択可否をログに出力"
          - "後集計のための構造化ログ"

    verification_criteria:
      - "Acceptance Rateを計算するワークフローが存在する"
      - "各Action実行時にメトリクスが記録される"
      - "時系列でのAcceptance Rate変化を可視化できる"

    rollback_plan:
      - "メトリクス収集は既存Actionの動作に影響しない"
      - "outputs追加のみで既存ロジックは変更せず"

  # === High Priority Gaps ===

  - id: "GAP-002"
    category: "Documentation"
    severity: "High"
    title: "実際の運用事例とトラブルシューティング情報の不足"
    description: "Phase 3のAdoptionが未完了であり、実際の運用経験が文書化されていない"

    intent_reference:
      source: "intent.yml assumptions.ASM-005"
      target: "Phase 3: Stabilization & Adoption（一部進行中）"
      assumption: "現在Phase 3が進行中であり、組織内プロジェクトへの導入が残タスク"

    current_state:
      source: "as_is.yml operational_status"
      status: "production_usage: Unknown (Phase 3 adoption not started)"
      evidence: "C-103: 実際のSelf-hosted runnerでの実行経験は限定的 (confidence: 0.5)"

    gap_details:
      what_is_missing: "実際の運用事例、パフォーマンスデータ、トラブルシューティングガイド"
      impact: "導入検討組織が参考情報を得られない。問題発生時の対応手順が不明"
      business_impact: "導入ハードルが上がり、Phase 3のAdoptionが遅れる"

    proposed_solutions:
      - id: "SOL-002-A"
        description: "パイロット導入の実施とケーススタディの作成"
        effort: "High"
        impact: "High"
        depends_on: "組織内のパイロットプロジェクト"
        details:
          - "ADOPTION_GUIDE.mdに従いパイロット導入を実施"
          - "導入プロセス、課題、成果を文書化"
          - "ADOPTION_GUIDE.mdにケーススタディセクションを追加"

      - id: "SOL-002-B"
        description: "トラブルシューティングガイドの作成"
        effort: "Medium"
        impact: "Medium"
        details:
          - "各Actionのinstructionに「Troubleshooting」セクションを追加"
          - "よくあるエラーと解決方法を記載"
          - "GitHub Issuesの実際の事例を反映"

    verification_criteria:
      - "ADOPTION_GUIDE.mdに少なくとも1つのケーススタディが存在"
      - "各主要Actionにトラブルシューティングセクションが存在"
      - "FAQや既知の問題が文書化されている"

  - id: "GAP-003"
    category: "Testing"
    severity: "High"
    title: "実行時テストの不在"
    description: "構造的テストのみで、実際のGitHub Actions環境での実行テストが不足"

    intent_reference:
      source: "intent.yml quality_attributes.QA-001"
      target: "全ActionsがDry Runモードで検証可能"
      assumption: "ASM-003: 全Actionsに対するDry Run検証が実装されている"

    current_state:
      source: "as_is.yml testing_status"
      status: "runtime_execution: Not Implemented (intentional)"
      evidence: "TESTING.md: 構造的テストアプローチが採用されている"

    gap_details:
      what_is_missing: "実際のGitHub Actions runtime環境でのEnd-to-Endテスト"
      impact: "構造は正しくても、実行時に失敗する可能性がある。Claude Code CLIとの連携が検証されていない"
      business_impact: "実際に使用した際に予期せぬエラーが発生するリスク"

    note: "このギャップは意図的な設計判断（TESTING.mdで説明）だが、より完全な検証には改善の余地あり"

    proposed_solutions:
      - id: "SOL-003-A"
        description: "実際のself-hosted runnerでのIntegration Testを追加（オプション）"
        effort: "High"
        impact: "Medium"
        details:
          - "self-hosted runner環境が必要"
          - "テスト用リポジトリでの実際のPR作成・マージを検証"
          - "CIには含めず、手動実行テストとして位置づけ"

      - id: "SOL-003-B"
        description: "モック実行テストの強化"
        effort: "Medium"
        impact: "Medium"
        details:
          - "Claude Code CLIのモックを作成"
          - "プロンプト生成と引数渡しのテストを強化"
          - "実際のCLI呼び出しをシミュレート"

    verification_criteria:
      - "構造的テストに加え、モック実行テストが存在"
      - "主要なActionについてself-hosted runnerでの検証記録が存在"

  - id: "GAP-004"
    category: "Monitoring & Observability"
    severity: "High"
    title: "モニタリングとアラートの不在"
    description: "Actionの実行状態やパフォーマンスを監視する仕組みがない"

    intent_reference:
      source: "intent.yml mission.desired_state"
      target: "組織内の複数リポジトリで採用され、AIに任せられる雑務が増え、人間が本質的な設計や意思決定に集中できる時間が増加している状態"
      assumption: "本番運用を前提とした設計"

    current_state:
      source: "as_is.yml operational_status"
      status: "monitoring: Not Implemented, alerting: Not Implemented"
      evidence: "実運用での監視体制が整備されていない"

    gap_details:
      what_is_missing: "Actionの成功/失敗率、実行時間、エラー率を監視する仕組み"
      impact: "問題発生時に即座に検知できない。品質低下や障害に気づきにくい"
      business_impact: "信頼性の低下、ユーザー信頼の損失"

    proposed_solutions:
      - id: "SOL-004-A"
        description: "GitHub Actionsの組み込み監視機能を使用"
        effort: "Low"
        impact: "Medium"
        details:
          - "GitHub Notificationsで失敗したworkflowを監視"
          - "workflow runのstatusをSlack等に通知"
          - "GitHubのInsightsとSecurity機能を活用"

      - id: "SOL-004-B"
        description: "メトリクスダッシュボードの作成"
        effort: "Medium"
        impact: "High"
        details:
          - "aggregate-metrics.ymlで収集したデータを可視化"
          - "Acceptance Rate、実行時間、成功率のグラフ化"
          - "GitHub Pages等でダッシュボードを公開"

    verification_criteria:
      - "失敗したworkflow実行を検知する方法が存在"
      - "主要なメトリクス（実行回数、成功率、平均実行時間）が可視化されている"

  # === Medium Priority Gaps ===

  - id: "GAP-005"
    category: "Documentation"
    severity: "Medium"
    title: "パフォーマンスとコスト情報の不足"
    description: "各Actionの実行時間やClaude API使用量などの定量的情報がない"

    intent_reference:
      source: "intent.yml mission.provided_value"
      target: "従来の正規表現や静的解析では不可能な、文脈を理解した高度な自動化を実現"
      assumption: "パフォーマンスとコストのバランスが適切である必要がある"

    current_state:
      source: "as_is.yml quality_metrics.weaknesses"
      status: "実行時のパフォーマンス測定不在"
      evidence: "C-202: Claude Code CLIの実際の実行性能とコスト (unknown)"

    gap_details:
      what_is_missing: "各Actionの平均実行時間、Claude API使用量、コスト見積もり"
      impact: "導入検討時にコストメリットを評価できない"
      business_impact: "導入の可否判断が難しい"

    proposed_solutions:
      - id: "SOL-005-A"
        description: "ベンチマークテストの実施と文書化"
        effort: "Medium"
        impact: "Medium"
        details:
          - "代表的なワークロードでの実行時間を計測"
          - "Claude APIのトークン使用量を記録"
          - "README.mdまたは各instructionにパフォーマンス情報を追加"

    verification_criteria:
      - "主要なActionについて実行時間とコストの見積もりが記載されている"

  - id: "GAP-006"
    category: "Development Workflow"
    severity: "Medium"
    title: "ブランチ戦略とリリース手順の未文書化"
    description: "開発フロー、ブランチ戦略、リリース手順が明記されていない"

    intent_reference:
      source: "intent.yml constraints.OC-001"
      target: "全てのActionに導入ガイド（Instructions）と利用例（Examples）が必須"
      assumption: "開発プロセスも標準化されている必要がある"

    current_state:
      source: "as_is.yml development_practices"
      status: "branching_strategy: Unknown (not documented)"
      evidence: "CONTRIBUTING.md等の開発者向けドキュメントが見当たらない"

    gap_details:
      what_is_missing: "CONTRIBUTING.md、ブランチ戦略、PRテンプレート、リリース手順"
      impact: "外部からの貢献がしづらい。リリースプロセスが不透明"
      business_impact: "エコシステムの成長が制限される"

    proposed_solutions:
      - id: "SOL-006-A"
        description: "CONTRIBUTING.mdの作成"
        effort: "Low"
        impact: "Medium"
        details:
          - "開発環境のセットアップ手順"
          - "テストの実行方法"
          - "PRの提出方法とレビュー基準"
          - "ブランチ命名規則"

      - id: "SOL-006-B"
        description: "リリース手順の文書化"
        effort: "Low"
        impact: "Medium"
        details:
          - "バージョニング方針（Semantic Versioning等）"
          - "リリースチェックリスト"
          - "CHANGELOG.mdの作成"

    verification_criteria:
      - "CONTRIBUTING.mdが存在し、開発手順が記載されている"
      - "リリース手順が文書化されている"

  # === Low Priority Gaps ===

  - id: "GAP-007"
    category: "Usability"
    severity: "Low"
    title: "クイックスタートガイドの不在"
    description: "初心者向けの「5分で試せる」クイックスタートがない"

    intent_reference:
      source: "intent.yml mission.target_user"
      target: "GitHub組織の開発チーム（特にSelf-hosted runner環境を運用するチーム）"
      assumption: "既にself-hosted runner環境があることを前提"

    current_state:
      source: "as_is.yml documentation_status"
      status: "導入ガイドは存在するが、全体の説明から始まっている"
      evidence: "ADOPTION_GUIDE.mdは詳細だが、段階的"

    gap_details:
      what_is_missing: "最もシンプルなActionを5分で試せるクイックスタート"
      impact: "導入の心理的ハードルが高い"
      business_impact: "試しに使ってみる層へのアプローチが弱い"

    proposed_solutions:
      - id: "SOL-007-A"
        description: "QUICKSTART.mdの作成"
        effort: "Low"
        impact: "Low"
        details:
          - "最もシンプルなAction（例：auto-merge）の例"
          - "最小限の設定で試す手順"
          - "3ステップで完了するように構成"

    verification_criteria:
      - "README.mdに「Quick Start」セクションが存在"
      - "5分以内に試せる例が提示されている"

# === Gap Priority Matrix ===
priority_matrix:
  urgent: ["GAP-001"]  # Acceptance Rate追跡（成功条件に関わる）
  high: ["GAP-002", "GAP-003", "GAP-004"]  # 運用、テスト、監視
  medium: ["GAP-005", "GAP-006"]  # パフォーマンス情報、開発フロー
  low: ["GAP-007"]  # クイックスタート

# === Assumption-based Gaps ===
# 仮定に基づいて検出されたギャップ

assumption_based_gaps:
  - id: "GAP-ASM-001"
    assumption_ref: "ASM-001"
    assumption: "中〜大規模なGitHub組織（10〜100人規模の開発チーム）"
    gap: "大規模組織向けの権限管理やガバナンスのガイダンスが不足"
    severity: "Medium"
    proposed_action: "大規模組織向けの導入ガイドセクションを追加"

  - id: "GAP-ASM-002"
    assumption_ref: "ASM-002"
    assumption: "Self-hosted runner上でClaude Code CLIが実行可能な環境"
    gap: "Claude Code CLIのセットアップ手順が詳細には記載されていない"
    severity: "Medium"
    proposed_action: "Claude Code CLIのインストールと設定ガイドを別ドキュメントとして作成"
