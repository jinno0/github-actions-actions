# PR-001: Test Coverage Framework Setup

**Status:** Proposed
**Priority:** High
**Estimated Impact:** High
**Risk:** Low

## Problem

- テストカバレッジが測定されていない
- 品質の可視化ができていない
- 改善の効果測定ができない

## Proposed Solution

### 1. pytest-cov の導入

```bash
# pyproject.toml または requirements.txt に追加
pytest-cov>=4.1.0
```

### 2. pyproject.toml の設定追加

```toml
[tool.pytest.ini_options]
testpaths = ["tests"]
python_files = ["test_*.py"]
python_classes = ["Test*"]
python_functions = ["test_*"]
addopts = "--cov=. --cov-report=term-missing --cov-report=html --cov-report=xml"

[tool.coverage.run]
omit = [
    "tests/*",
    "*/venv/*",
    "*/site-packages/*"
]

[tool.coverage.report]
fail_under = 80
```

### 3. テスト構成の例を作成

```python
# tests/test_example.py
def test_example():
    assert True
```

### 4. CI でのカバレッジレポート追加

```yaml
# .github/workflows/test.yml
- name: Run tests with coverage
  run: |
    pytest --cov=. --cov-report=xml --cov-report=term

- name: Upload coverage reports
  uses: codecov/codecov-action@v3
  with:
    file: ./coverage.xml
```

## Files to Change

| File | Action | Lines Added | Lines Removed |
|------|--------|-------------|---------------|
| `pyproject.toml` | Modified | ~20 | 0 |
| `tests/test_example.py` | Created | ~10 | 0 |
| `.github/workflows/test.yml` | Modified | ~10 | 0 |

## Verification Steps

1. `pytest --cov` を実行
2. カバレッジレポートが生成されることを確認
3. カバレッジが 0% でも計測できれば成功

## Expected Impact

- テストカバレッジが可視化される
- 目標値 (80%) への進捗を追跡できる
- 他の改善の効果測定が可能になる

## Rollback Plan

```bash
git checkout pyproject.toml
rm tests/test_example.py
```
