# PR-004: Fix YAML Syntax Errors (ISS-NEW-001)

## Summary
Fix 3 YAML syntax errors identified by yamllint that are blocking CI quality gate.

**Priority**: HIGH (CI Blocker)
**Estimated Effort**: 15 minutes
**Type**: Bug Fix
**Gap Resolved**: ISS-NEW-001

## Problem Statement

The yamllint CI job (added in PR-001) is currently failing due to 3 YAML syntax errors:

1. **actions/review-and-merge/action.yml:83**
   - Error: `missing new line at end of file`
   - Impact: File doesn't end with newline character

2. **actions/auto-document/action.yml:58**
   - Error: `too many blank lines (1 > 0)`
   - Impact: Extra blank line violates YAML style rules

3. **actions/auto-refactor/action.yml:64**
   - Error: `too many blank lines (1 > 0)`
   - Impact: Extra blank line violates YAML style rules

These errors prevent PRs from passing CI, blocking development workflow.

## Root Cause

- Files were created without strict YAML linting enforcement
- Newline-at-end-of-file convention not consistently applied
- Extra blank lines introduced during editing

## Solution

### Changes Required

#### 1. Fix `actions/review-and-merge/action.yml`
```bash
# Add newline at end of file
echo "" >> actions/review-and-merge/action.yml
```

**Verification**:
```bash
tail -c 1 actions/review-and-merge/action.yml | od -An -tx1
# Should output: 0a (newline character)
```

#### 2. Fix `actions/auto-document/action.yml`
```bash
# Remove extra blank line at line 58
sed -i '58d' actions/auto-document/action.yml
```

**Verification**:
```bash
yamllint actions/auto-document/action.yml
# Should pass without errors
```

#### 3. Fix `actions/auto-refactor/action.yml`
```bash
# Remove extra blank line at line 64
sed -i '64d' actions/auto-refactor/action.yml
```

**Verification**:
```bash
yamllint actions/auto-refactor/action.yml
# Should pass without errors
```

### Implementation Steps

1. Create feature branch:
   ```bash
   git checkout -b fix/yaml-syntax-errors
   ```

2. Apply fixes:
   ```bash
   # Fix review-and-merge
   echo "" >> actions/review-and-merge/action.yml

   # Fix auto-document (verify line 58 first)
   sed -i '58{ /^$/d; }' actions/auto-document/action.yml

   # Fix auto-refactor (verify line 64 first)
   sed -i '64{ /^$/d; }' actions/auto-refactor/action.yml
   ```

3. Verify all fixes:
   ```bash
   yamllint actions/review-and-merge/action.yml \
             actions/auto-document/action.yml \
             actions/auto-refactor/action.yml
   ```

4. Run full test suite:
   ```bash
   pytest --cov=. --cov-report=term-missing
   ```

5. Commit changes:
   ```bash
   git add actions/review-and-merge/action.yml \
             actions/auto-document/action.yml \
             actions/auto-refactor/action.yml
   git commit -m "fix: Add missing newlines at end of action.yml files"
   ```

6. Push and create PR

## Testing Plan

### Pre-merge Verification
1. Run yamllint on all 3 files (must pass with 0 errors)
2. Run full test suite (must pass all 455 tests)
3. Verify CI workflow passes

### Post-merge Verification
1. Monitor CI workflow on next PR
2. Confirm yamllint job passes
3. Verify no regressions in action functionality

## Rollback Plan

If issues arise:
1. Revert commit: `git revert <commit-hash>`
2. Actions will continue to work (errors are style, not functional)
3. CI will fail but development can continue

**Rollback Command**:
```bash
git revert HEAD --no-edit
git push origin <branch>
```

## Success Criteria

- [ ] yamllint passes with 0 errors on all 3 files
- [ ] Full test suite passes (455 tests)
- [ ] CI workflow completes successfully
- [ ] No regressions in action functionality
- [ ] PR can be merged without CI blocking

## Related Issues

- Resolves: ISS-NEW-001
- Follows up: PR-001 (yamllint integration)

## Additional Notes

- This is a **quick win** - simple fixes with high impact
- Changes are minimal and low-risk
- No functional code changes, only YAML formatting
- Estimated time: 15 minutes total

## Verification Commands

```bash
# Quick verification
yamllint actions/*/action.yml 2>&1 | grep -E "(error|Error)" | wc -l
# Expected: 0

# Full verification
pytest --cov=. --cov-report=term-missing -q
# Expected: 455 passed, 2 skipped
```
