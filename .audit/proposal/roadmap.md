# 改善ロードマップ

**作成日**: 2025-02-03
**更新日**: 2026-02-03
**作成者**: Repo Genesis Auditor (run-initial → run-cycle4)
**バージョン**: 4.0

## 概要

本ロードマップは、`github-actions-actions` リポジトリの監査結果に基づく改善提案を優先順位付きで整理したものです。

**Cycle 1 実施状況**: ✅ 完了 (2026-02-03)
- 品質スコア: 25/25
- 成功率: 100% (3/3 PRs成功)
- 統合テストカバレッジ: 0% → 53.8%

**Cycle 2 実施状況**: ✅ 完了 (2026-02-03)
- 品質スコア: 25/25
- 成功率: 100% (2/2 PRs成功)
- 統合テストカバレッジ: 53.8% → 100%
- 構造的テストカバレッジ: 94.49% (維持)

**Cycle 3 実施状況**: ✅ 完了 (2026-02-03)
- 品質スコア: 25/25
- 成功率: 100% (2/2 PRs成功)
- 統合テストカバレッジ: 100% (達成)
- 統合テストカバレッジ定義: 文書化完了

**Cycle 4 実施予定**: 🔄 提案段階
- 目標: Phase 2b (ランタイムテスト) 導入

## 優先順位の原則

1. **安全性 > 品質 > 可視化**
2. **統合テストの完全実装** ✅ (Cycle 2, 3で完了)
3. **ランタイムテストの導入** 🔄 (Cycle 4で実施予定)
4. **品質メトリクスの精緻化** 🔄 (Cycle 4で実施予定)

---

## Phase 1: 構造的テストの基盤構築 ✅ (完了)

**期間**: Cycle 1で完了
**関連PR**: PR-001 (functional testing)
**達成状況**: ✅ 100%達成

### 達成内容

- ✅ 構造的テストカバレッジ: 97.51% → 94.49% (維持)
- ✅ 統合テスト基盤の構築
- ✅ テスト環境の構築
- ✅ CIでの自動実行設定

---

## Phase 2: 統合テストの完全実装 ✅ (完了)

**期間**: Cycle 2, 3で完了
**関連PR**: PR-004, PR-005
**達成状況**: ✅ 100%達成

### 達成内容 (Cycle 2)
- ✅ 統合テストカバレッジ: 53.8% → 100%
- ✅ 統合テストファイル: 7 → 13 files
- ✅ 全13 Actionsが統合テストで検証される

### 達成内容 (Cycle 3)
- ✅ 統合テストカバレッジ定義の文書化
- ✅ Action-Level & Field-Levelカバレッジ定義
- ✅ TESTING.md更新 (Phase 2完了マーク)

### 成功基準 (達成済み)

- ✅ 全13 Actionsで統合テストが実装されている
- ✅ CIで統合テストが自動実行されている
- ✅ 統合テストのカバレッジが100% (Actions数ベース)
- ✅ カバレッジ定義が文書化されている

---

## Phase 2b: ランタイムテストの導入 🔄 (Cycle 4で実施予定)

**期間**: 2-3日
**関連PR**: PR-006 (runtime testing with act)
**関連ギャップ**: GAP-007

### 目標

統合テスト（YAML構造検証）に加え、**actツール**を使用した実際のGitHub Actions実行テストを導入する。

### マイルストーン

1. **Day 1: actツールのセットアップ**
   - [ ] actツールのインストールと検証
   - [ ] `tests/runtime/` ディレクトリの作成
   - [ ] テストフィクスチャの実装 (`conftest.py`)

2. **Day 2: 重要なActionのランタイムテスト実装**
   - [ ] `review-and-merge` actionのランタイムテスト
   - [ ] `auto-merge` actionのランタイムテスト
   - [ ] `action-fixer` actionのランタイムテスト

3. **Day 3: CI統合とドキュメント**
   - [ ] CIワークフローにruntime-testsジョブ追加
   - [ ] TESTING.mdの更新 (Phase 2b status)
   - [ ] ドキュメント作成 (actツールの使用方法)

### 成功基準

- [ ] actツールがインストール・設定されている (`act --version` 成功)
- [ ] 重要な3 Actionでランタイムテストが実装されている
- [ ] CIでランタイムテストが自動実行されている
- [ ] 構造的テストカバレッジ >= 90% (維持)
- [ ] 統合テストカバレッジ100% (維持)

### 期待される効果

- **Before**: ランタイムエラー検出不能
- **After**: 実行時エラーをCIで検出可能
- **信頼性**: YAML構造 + ランタイム実行の両方を検証

### 依存関係

- なし（独立して実装可能）

---

## Phase 2c: Field-Levelカバレッジ追跡 🔜 (Cycle 4で実施予定)

**期間**: 1日
**関連PR**: PR-007 (field-level coverage tracking)
**関連ギャップ**: GAP-008

### 目標

Action-Levelカバレッジ（100%）に加え、**Field-Levelカバレッジ**（各Actionで検証されるYAMLフィールドの割合）の追跡を実装する。

### マイルストーン

1. **Field-Levelカバレッジ計算スクリプトの実装**
   - [ ] `scripts/calculate_field_coverage.py` の実装
   - [ ] action.ymlからフィールド抽出
   - [ ] 統合テストから検証済みフィールド抽出

2. **統合テストへのフィールド検証リスト追加**
   - [ ] 12統合テストファイルにフィールドリスト追加
   - [ ] 各テストで検証するフィールドを明示

3. **CIワークフローとドキュメントの更新**
   - [ ] CIでカバレッジ計算を実行
   - [ ] TESTING.mdにField-Levelカバレッジ報告追加

### 成功基準

- [ ] Field-Levelカバレッジ計算スクリプトが実装されている
- [ ] 統合テストでフィールド検証リストが作成されている
- [ ] TESTING.mdにField-Levelカバレッジ報告が追加されている
- [ ] CIでカバレッジレポートが生成されている

### 期待される効果

- **Before**: YAMLフィールド検証の深度不明
- **After**: 各Actionのフィールドカバレッジが可視化
- **改善の方向性**: 未検証フィールドが明示的に分かる

### 依存関係

- なし（独立して実装可能）

---

## Phase 3: 品質メトリクスの充実化 ✅ (完了)

**期間**: Cycle 1で完了
**関連PR**: PR-002 (quality metrics dashboard), PR-003 (telemetry)
**達成状況**: ✅ インフラ完了

### 達成内容

- ✅ QUALITY_METRICS.mdの作成
- ✅ ADOPTION_REPORT.mdの作成
- ✅ テレメトリー収集インフラの構築
- ✅ calculate_acceptance_rate.pyの実装

### 現状

- インフラは完了
- 実データの収集待ち（自然な状態）

---

## Phase 4: 低優先度の改善 (優先度: LOW)

**期間**: 随時
**関連ギャップ**: GAP-009, GAP-010

### GAP-009: 品質メトリクスダッシュボードへの実データ投入

- インフラは完了
- 30日以上の実データ収集待ち
- 自然的に解消する優先度は低い

### GAP-010: 採用率レポートの実データ投入

- テレメトリーシステムは実装済み
- 実際の使用データ待ち
- 採用活動を強化することで解消

---

## 実装スケジュール（履歴と予定）

```text
Past (Completed):
  Cycle 1 (2026-02-03): Phase 1 構造的テスト基盤構築 ✅
  Cycle 2 (2026-02-03): Phase 2 統合テスト Part 1 ✅
  Cycle 3 (2026-02-03): Phase 2 統合テスト Part 2 ✅

Current (Cycle 4):
  Phase 2b: ランタイムテスト導入 (2-3 days) 🔄
  Phase 2c: Field-Levelカバレッジ追跡 (1 day) 🔜

Future:
  Phase 2b (残りAction): ランタイムテスト拡張 (次サイクル)
  Phase 3: 品質メトリクス実データ収集 (継続)
```

---

## リソース見積もり

| Phase | 作業量（人日） | 優先度 | 状態 |
|-------|--------------|--------|------|
| Phase 1 | 10-15人日 | HIGH | ✅ 完了 |
| Phase 2 | 5-8人日 | HIGH | ✅ 完了 |
| Phase 2b | 2-3人日 | HIGH | 🔄 実施予定 |
| Phase 2c | 1人日 | MEDIUM | 🔜 実施予定 |
| Phase 3 | 5-8人日 | MEDIUM | ✅ インフラ完了 |
| Phase 4 | 3-5人日 | LOW | 🔜 随時 |
| **合計** | **26-40人日** | - | - |

---

## 成功指標（KPI）

全改善完了後の目標値:

| 指標 | 現状 | 目標 | 評価方法 | 状態 |
|------|------|------|----------|------|
| 構造的テストカバレッジ | 94.49% | >= 90% | pytest --cov | ✅ 達成 |
| 統合テストカバレッジ (Action-Level) | 100% | 100% | pytest tests/integration/ | ✅ 達成 |
| 統合テストカバレッジ (Field-Level) | 未追跡 | >= 80% | calculate_field_coverage.py | 🔜 Cycle 4 |
| ランタイムテストカバレッジ | 0% | >= 3 Actions | act + pytest | 🔄 Cycle 4 |
| 受入率（Acceptance Rate） | 不明 | >= 70% | QUALITY_METRICS.md | 🔜 データ収集中 |
| 導入リポジトリ数 | 不明 | 増加傾向 | ADOPTION_REPORT.md | 🔜 データ収集中 |

---

## 次のアクション

### Cycle 4 のアクション

1. **PR-006のレビューと承認**: Phase 2b (ランタイムテスト) 導入
2. **PR-007のレビューと承認**: Phase 2c (Field-Levelカバレッジ) 追跡
3. **15_repo_improvement_executor で実行**: 提案された改善を適用
4. **進捗管理**: 実行結果を feedback_to_auditor.yml に記録

### 今後の改善サイクル

1. **Cycle 5**: Phase 2bの残りActionに拡張
2. **Cycle 6+**: Field-Levelカバレッジ80%以上を目標に改善
3. **継続**: 品質メトリクスの実データ収集

---

**備考**:

- 各Phaseは独立しており、並行実行が可能
- 優先度は状況によって変更される可能性がある
- 定期的（サイクル毎）な監査を実施済み
- 品質トラジェクトリ: 改善傾向が継続中
